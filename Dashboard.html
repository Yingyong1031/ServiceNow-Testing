<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ServiceNow Testing Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .card {
            margin: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        .card:hover {
            transform: translateY(-5px);
        }
        .dashboard-header {
            background-color: #0c5d8c;
            color: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 5px;
        }
        .test-card {
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="row dashboard-header">
            <div class="col-md-12">
                <h1><i class="bi bi-speedometer2"></i> ServiceNow Testing Dashboard</h1>
                <p>Monitor and manage your ServiceNow test cases and results</p>
            </div>
        </div>

        <div class="row">
            <!-- Test Summary Card -->
            <div class="col-md-3">
                <div class="card text-white bg-primary">
                    <div class="card-body">
                        <h5 class="card-title">Total Tests</h5>
                        <h2 class="display-4" id="totalTests">0</h2>
                    </div>
                </div>
            </div>

            <!-- Passed Tests Card -->
            <div class="col-md-3">
                <div class="card text-white bg-success">
                    <div class="card-body">
                        <h5 class="card-title">Passed</h5>
                        <h2 class="display-4" id="passedTests">0</h2>
                    </div>
                </div>
            </div>

            <!-- Failed Tests Card -->
            <div class="col-md-3">
                <div class="card text-white bg-danger">
                    <div class="card-body">
                        <h5 class="card-title">Failed</h5>
                        <h2 class="display-4" id="failedTests">0</h2>
                    </div>
                </div>
            </div>

            <!-- Pending Tests Card -->
            <div class="col-md-3">
                <div class="card text-white bg-warning">
                    <div class="card-body">
                        <h5 class="card-title">Pending</h5>
                        <h2 class="display-4" id="pendingTests">0</h2>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mt-4">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">
                        <h5>Test Execution</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <button id="runAllTests" class="btn btn-primary">
                                    <i class="bi bi-play-fill"></i> Run All Tests
                                </button>
                                <button id="runSelectedTests" class="btn btn-secondary">
                                    <i class="bi bi-play"></i> Run Selected
                                </button>
                            </div>
                            <div class="col-md-6 text-end">
                                <div class="input-group mb-3">
                                    <input type="text" id="testSearch" class="form-control" placeholder="Search tests...">
                                    <button class="btn btn-outline-secondary" type="button">
                                        <i class="bi bi-search"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="table-responsive mt-3">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th><input type="checkbox" id="selectAll"></th>
                                        <th>Test Name</th>
                                        <th>Status</th>
                                        <th>Last Run</th>
                                        <th>Duration</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="testTableBody">
                                    <!-- Test rows will be added dynamically -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Test Details Modal -->
    <div class="modal fade" id="testDetailsModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="testDetailsModalLabel">Test Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="testDetailsContent">
                    <!-- Test details will be loaded here -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary">View Full Logs</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Sample test data - in a real app, this would come from an API
        const testData = [
            { id: 1, name: 'Login Test', status: 'pending', lastRun: 'Never', duration: 'N/A' },
            { id: 2, name: 'Create Incident', status: 'pending', lastRun: 'Never', duration: 'N/A' },
            { id: 3, name: 'Update Incident', status: 'pending', lastRun: 'Never', duration: 'N/A' },
            { id: 4, name: 'Close Incident', status: 'pending', lastRun: 'Never', duration: 'N/A' },
        ];

        // Initialize the dashboard
        document.addEventListener('DOMContentLoaded', function() {
            updateTestSummary();
            renderTestTable();
            setupEventListeners();
        });

        function updateTestSummary() {
            const total = testData.length;
            const passed = testData.filter(test => test.status === 'passed').length;
            const failed = testData.filter(test => test.status === 'failed').length;
            const pending = testData.filter(test => test.status === 'pending').length;

            document.getElementById('totalTests').textContent = total;
            document.getElementById('passedTests').textContent = passed;
            document.getElementById('failedTests').textContent = failed;
            document.getElementById('pendingTests').textContent = pending;
        }

        function renderTestTable(filter = '') {
            const tbody = document.getElementById('testTableBody');
            tbody.innerHTML = '';

            const filteredTests = filter 
                ? testData.filter(test => 
                    test.name.toLowerCase().includes(filter.toLowerCase()))
                : testData;

            filteredTests.forEach(test => {
                const row = document.createElement('tr');
                row.className = 'test-card';
                row.setAttribute('data-test-id', test.id);
                
                const statusBadge = getStatusBadge(test.status);
                
                row.innerHTML = `
                    <td><input type="checkbox" class="test-checkbox" data-test-id="${test.id}"></td>
                    <td>${test.name}</td>
                    <td>${statusBadge}</td>
                    <td>${test.lastRun}</td>
                    <td>${test.duration}</td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary run-test" data-test-id="${test.id}">
                            <i class="bi bi-play"></i> Run
                        </button>
                        <button class="btn btn-sm btn-outline-secondary view-details" data-test-id="${test.id}">
                            <i class="bi bi-info-circle"></i> Details
                        </button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }

        function getStatusBadge(status) {
            const statusClasses = {
                'passed': 'success',
                'failed': 'danger',
                'pending': 'warning',
                'running': 'info'
            };
            
            return `<span class="badge bg-${statusClasses[status] || 'secondary'}">
                ${status.charAt(0).toUpperCase() + status.slice(1)}
            </span>`;
        }

        function setupEventListeners() {
            // Search functionality
            document.getElementById('testSearch').addEventListener('input', (e) => {
                renderTestTable(e.target.value);
            });

            // Select all checkbox
            document.getElementById('selectAll').addEventListener('change', (e) => {
                const checkboxes = document.querySelectorAll('.test-checkbox');
                checkboxes.forEach(checkbox => {
                    checkbox.checked = e.target.checked;
                });
            });

            // Run all tests
            document.getElementById('runAllTests').addEventListener('click', () => {
                if (confirm('Are you sure you want to run all tests?')) {
                    // In a real app, this would trigger your test runner
                    alert('Running all tests...');
                }
            });

            // Run selected tests
            document.getElementById('runSelectedTests').addEventListener('click', () => {
                const selectedTests = Array.from(document.querySelectorAll('.test-checkbox:checked'))
                    .map(checkbox => checkbox.getAttribute('data-test-id'));
                
                if (selectedTests.length === 0) {
                    alert('Please select at least one test to run');
                    return;
                }
                
                if (confirm(`Run ${selectedTests.length} selected test(s)?`)) {
                    // In a real app, this would trigger your test runner for selected tests
                    alert(`Running tests: ${selectedTests.join(', ')}`);
                }
            });

            // Event delegation for dynamic elements
            document.addEventListener('click', (e) => {
                // Run test button
                if (e.target.closest('.run-test')) {
                    const testId = e.target.closest('.run-test').getAttribute('data-test-id');
                    const test = testData.find(t => t.id == testId);
                    if (test) {
                        // In a real app, this would trigger the specific test
                        alert(`Running test: ${test.name}`);
                    }
                }
                
                // View details button
                if (e.target.closest('.view-details')) {
                    const testId = e.target.closest('.view-details').getAttribute('data-test-id');
                    const test = testData.find(t => t.id == testId);
                    if (test) {
                        showTestDetails(test);
                    }
                }
                
                // Click on test row
                if (e.target.closest('tr.test-card') && !e.target.closest('td:first-child')) {
                    const testId = e.target.closest('tr').getAttribute('data-test-id');
                    const test = testData.find(t => t.id == testId);
                    if (test) {
                        showTestDetails(test);
                    }
                }
            });
        }

        function showTestDetails(test) {
            const modal = new bootstrap.Modal(document.getElementById('testDetailsModal'));
            const modalTitle = document.getElementById('testDetailsModalLabel');
            const modalContent = document.getElementById('testDetailsContent');
            
            modalTitle.textContent = test.name;
            
            // In a real app, you would fetch detailed test information here
            modalContent.innerHTML = `
                <div class="mb-3">
                    <h6>Test Information</h6>
                    <p><strong>Status:</strong> ${getStatusBadge(test.status)}</p>
                    <p><strong>Last Run:</strong> ${test.lastRun}</p>
                    <p><strong>Duration:</strong> ${test.duration}</p>
                </div>
                <div class="mb-3">
                    <h6>Description</h6>
                    <p>This is a sample test description. In a real application, this would contain detailed information about the test case, steps, and expected results.</p>
                </div>
                <div>
                    <h6>Last Execution Logs</h6>
                    <div class="bg-light p-2" style="max-height: 200px; overflow-y: auto; font-family: monospace;">
                        <div>No execution logs available. Run the test to see the logs.</div>
                    </div>
                </div>
            `;
            
            modal.show();
        }
    </script>
</body>
</html>
